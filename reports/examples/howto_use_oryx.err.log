Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from oryx.core.ppl import joint_sample

bnn = mlp([50, 50], num_classes)
rng_key, init_key = jax.random.split(rng_key)
initial_weights = joint_sample(bnn)(init_key, jnp.ones(num_features))

print(initial_weights.keys())
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[7], line 5[0m
[1;32m      3[0m bnn [38;5;241m=[39m mlp([[38;5;241m50[39m, [38;5;241m50[39m], num_classes)
[1;32m      4[0m rng_key, init_key [38;5;241m=[39m jax[38;5;241m.[39mrandom[38;5;241m.[39msplit(rng_key)
[0;32m----> 5[0m initial_weights [38;5;241m=[39m [43mjoint_sample[49m[43m([49m[43mbnn[49m[43m)[49m[43m([49m[43minit_key[49m[43m,[49m[43m [49m[43mjnp[49m[38;5;241;43m.[39;49m[43mones[49m[43m([49m[43mnum_features[49m[43m)[49m[43m)[49m
[1;32m      7[0m [38;5;28mprint[39m(initial_weights[38;5;241m.[39mkeys())

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:757[0m, in [0;36mreap.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m    756[0m [38;5;28;01mdef[39;00m [38;5;21mwrapped[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m--> 757[0m   [38;5;28;01mreturn[39;00m [43mcall_and_reap[49m[43m([49m
[1;32m    758[0m [43m      [49m[43mf[49m[43m,[49m
[1;32m    759[0m [43m      [49m[43mtag[49m[38;5;241;43m=[39;49m[43mtag[49m[43m,[49m
[1;32m    760[0m [43m      [49m[43mallowlist[49m[38;5;241;43m=[39;49m[43mallowlist[49m[43m,[49m
[1;32m    761[0m [43m      [49m[43mblocklist[49m[38;5;241;43m=[39;49m[43mblocklist[49m[43m,[49m
[1;32m    762[0m [43m      [49m[43mexclusive[49m[38;5;241;43m=[39;49m[43mexclusive[49m[43m)[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[[38;5;241m1[39m]

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:727[0m, in [0;36mcall_and_reap.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m    725[0m [38;5;28;01mwith[39;00m jax_core[38;5;241m.[39mnew_main(HarvestTrace) [38;5;28;01mas[39;00m main:
[1;32m    726[0m   flat_fun [38;5;241m=[39m reap_function(flat_fun, main, settings, [38;5;28;01mFalse[39;00m)
[0;32m--> 727[0m   out_flat, reaps [38;5;241m=[39m [43mflat_fun[49m[38;5;241;43m.[39;49m[43mcall_wrapped[49m[43m([49m[43mflat_args[49m[43m)[49m
[1;32m    728[0m   [38;5;28;01mdel[39;00m main
[1;32m    729[0m [38;5;28;01mreturn[39;00m tree_util[38;5;241m.[39mtree_unflatten(out_tree(), out_flat), reaps

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/linear_util.py:191[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    188[0m gen [38;5;241m=[39m gen_static_args [38;5;241m=[39m out_store [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    190[0m [38;5;28;01mtry[39;00m:
[0;32m--> 191[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    192[0m [38;5;28;01mexcept[39;00m:
[1;32m    193[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    194[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    195[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    196[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    197[0m   [38;5;66;03m# state.[39;00m
[1;32m    198[0m   [38;5;28;01mwhile[39;00m stack:

Cell [0;32mIn[5], line 9[0m, in [0;36mmlp.<locals>.forward[0;34m(key, x)[0m
[1;32m      7[0m keys [38;5;241m=[39m jax[38;5;241m.[39mrandom[38;5;241m.[39msplit(key, num_hidden [38;5;241m+[39m [38;5;241m1[39m)
[1;32m      8[0m [38;5;28;01mfor[39;00m i, (subkey, hidden_size) [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mzip[39m(keys[:[38;5;241m-[39m[38;5;241m1[39m], hidden_sizes)):
[0;32m----> 9[0m     x [38;5;241m=[39m [43mnest[49m[43m([49m[43mdense[49m[43m([49m[43mhidden_size[49m[43m)[49m[43m,[49m[43m [49m[43mscope[49m[38;5;241;43m=[39;49m[38;5;124;43mf[39;49m[38;5;124;43m'[39;49m[38;5;124;43mlayer_[39;49m[38;5;132;43;01m{[39;49;00m[43mi[49m[38;5;250;43m [39;49m[38;5;241;43m+[39;49m[38;5;250;43m [39;49m[38;5;241;43m1[39;49m[38;5;132;43;01m}[39;49;00m[38;5;124;43m'[39;49m[43m)[49m[43m([49m[43msubkey[49m[43m,[49m[43m [49m[43mx[49m[43m)[49m
[1;32m     10[0m logits [38;5;241m=[39m nest(dense(num_classes, activation[38;5;241m=[39m[38;5;28;01mlambda[39;00m x: x),
[1;32m     11[0m                 scope[38;5;241m=[39m[38;5;124mf[39m[38;5;124m'[39m[38;5;124mlayer_[39m[38;5;132;01m{[39;00mnum_hidden[38;5;250m [39m[38;5;241m+[39m[38;5;250m [39m[38;5;241m1[39m[38;5;132;01m}[39;00m[38;5;124m'[39m)(keys[[38;5;241m-[39m[38;5;241m1[39m], x)
[1;32m     12[0m [38;5;28;01mreturn[39;00m logits

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:314[0m, in [0;36mnest.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m    312[0m flat_args, in_tree [38;5;241m=[39m tree_util[38;5;241m.[39mtree_flatten(args)
[1;32m    313[0m flat_fun, out_tree [38;5;241m=[39m api_util[38;5;241m.[39mflatten_fun_nokwargs(fun, in_tree)
[0;32m--> 314[0m out_flat [38;5;241m=[39m [43mnest_p[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m
[1;32m    315[0m [43m    [49m[43mflat_fun[49m[43m,[49m
[1;32m    316[0m [43m    [49m[38;5;241;43m*[39;49m[43mflat_args[49m[43m,[49m
[1;32m    317[0m [43m    [49m[43mscope[49m[38;5;241;43m=[39;49m[43mscope[49m[43m,[49m
[1;32m    318[0m [43m    [49m[43mname[49m[38;5;241;43m=[39;49m[38;5;28;43mgetattr[39;49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43m__name__[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43m<no name>[39;49m[38;5;124;43m'[39;49m[43m)[49m[43m)[49m
[1;32m    319[0m [38;5;28;01mreturn[39;00m tree_util[38;5;241m.[39mtree_unflatten(out_tree(), out_flat)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:2309[0m, in [0;36mCallPrimitive.bind[0;34m(self, fun, *args, **params)[0m
[1;32m   2306[0m [38;5;28;01mdef[39;00m [38;5;21mbind[39m([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams):
[1;32m   2307[0m   call_bind_continuation, top_trace, fun_, tracers, params [38;5;241m=[39m (
[1;32m   2308[0m       call_bind_with_continuation([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams))
[0;32m-> 2309[0m   outs [38;5;241m=[39m [43mtop_trace[49m[38;5;241;43m.[39;49m[43mprocess_call[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mfun_[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m   2310[0m   [38;5;28;01mreturn[39;00m call_bind_continuation(outs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:365[0m, in [0;36mHarvestTrace.process_call[0;34m(self, call_primitive, f, tracers, params)[0m
[1;32m    363[0m context [38;5;241m=[39m trace_util[38;5;241m.[39mget_dynamic_context([38;5;28mself[39m)
[1;32m    364[0m [38;5;28;01mif[39;00m call_primitive [38;5;129;01mis[39;00m nest_p:
[0;32m--> 365[0m   [38;5;28;01mreturn[39;00m [43mcontext[49m[38;5;241;43m.[39;49m[43mprocess_nest[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mtracers[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m
[1;32m    366[0m [38;5;28;01mreturn[39;00m context[38;5;241m.[39mprocess_higher_order_primitive([38;5;28mself[39m, call_primitive, f,
[1;32m    367[0m                                               tracers, params, [38;5;28;01mFalse[39;00m)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:546[0m, in [0;36mReapContext.process_nest[0;34m(self, trace, f, scope, name, *tracers, **params)[0m
[1;32m    545[0m [38;5;28;01mdef[39;00m [38;5;21mprocess_nest[39m([38;5;28mself[39m, trace, f, [38;5;241m*[39mtracers, scope, name, [38;5;241m*[39m[38;5;241m*[39mparams):
[0;32m--> 546[0m   out_tracers, reap_tracers, _ [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreap_higher_order_primitive[49m[43m([49m
[1;32m    547[0m [43m      [49m[43mtrace[49m[43m,[49m[43m [49m[43mnest_p[49m[43m,[49m[43m [49m[43mf[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[38;5;28;43mdict[39;49m[43m([49m[43mparams[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m[43m [49m[43mscope[49m[38;5;241;43m=[39;49m[43mscope[49m[43m)[49m[43m,[49m[43m [49m[38;5;28;43;01mFalse[39;49;00m[43m)[49m
[1;32m    548[0m   tag [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msettings[38;5;241m.[39mtag
[1;32m    549[0m   [38;5;28;01mif[39;00m reap_tracers:

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:538[0m, in [0;36mReapContext.reap_higher_order_primitive[0;34m(self, trace, call_primitive, f, tracers, params, is_map)[0m
[1;32m    535[0m     [38;5;28;01mreturn[39;00m ([38;5;241m0[39m,) [38;5;241m*[39m out_tree[38;5;241m.[39mnum_leaves
[1;32m    537[0m   params [38;5;241m=[39m [38;5;28mdict[39m(params, out_axes_thunk[38;5;241m=[39mnew_out_axes_thunk)
[0;32m--> 538[0m out_flat [38;5;241m=[39m [43mcall_primitive[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mvals[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m
[1;32m    539[0m out_tree, metadata [38;5;241m=[39m aux()
[1;32m    540[0m out_vals, reaps [38;5;241m=[39m tree_util[38;5;241m.[39mtree_unflatten(out_tree, out_flat)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:2309[0m, in [0;36mCallPrimitive.bind[0;34m(self, fun, *args, **params)[0m
[1;32m   2306[0m [38;5;28;01mdef[39;00m [38;5;21mbind[39m([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams):
[1;32m   2307[0m   call_bind_continuation, top_trace, fun_, tracers, params [38;5;241m=[39m (
[1;32m   2308[0m       call_bind_with_continuation([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams))
[0;32m-> 2309[0m   outs [38;5;241m=[39m [43mtop_trace[49m[38;5;241;43m.[39;49m[43mprocess_call[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mfun_[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m   2310[0m   [38;5;28;01mreturn[39;00m call_bind_continuation(outs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:938[0m, in [0;36mEvalTrace.process_call[0;34m(self, primitive, f, tracers, params)[0m
[1;32m    937[0m [38;5;28;01mdef[39;00m [38;5;21mprocess_call[39m([38;5;28mself[39m, primitive, f, tracers, params):
[0;32m--> 938[0m   [38;5;28;01mreturn[39;00m [43mprimitive[49m[38;5;241;43m.[39;49m[43mimpl[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mtracers[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:257[0m, in [0;36m_nest_impl[0;34m(f, *args, **_)[0m
[1;32m    255[0m [38;5;28;01mdef[39;00m [38;5;21m_nest_impl[39m(f, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39m_):
[1;32m    256[0m   [38;5;28;01mwith[39;00m jax_core[38;5;241m.[39mnew_sublevel():
[0;32m--> 257[0m     [38;5;28;01mreturn[39;00m [43mf[49m[38;5;241;43m.[39;49m[43mcall_wrapped[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/linear_util.py:191[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    188[0m gen [38;5;241m=[39m gen_static_args [38;5;241m=[39m out_store [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    190[0m [38;5;28;01mtry[39;00m:
[0;32m--> 191[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    192[0m [38;5;28;01mexcept[39;00m:
[1;32m    193[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    194[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    195[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    196[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    197[0m   [38;5;66;03m# state.[39;00m
[1;32m    198[0m   [38;5;28;01mwhile[39;00m stack:

Cell [0;32mIn[4], line 12[0m, in [0;36mdense.<locals>.forward[0;34m(key, x)[0m
[1;32m     10[0m dim_in [38;5;241m=[39m x[38;5;241m.[39mshape[[38;5;241m-[39m[38;5;241m1[39m]
[1;32m     11[0m w_key, b_key [38;5;241m=[39m jax[38;5;241m.[39mrandom[38;5;241m.[39msplit(key)
[0;32m---> 12[0m w [38;5;241m=[39m [43mrandom_variable[49m[43m([49m
[1;32m     13[0m [43m    [49m[43mtfd[49m[38;5;241;43m.[39;49m[43mSample[49m[43m([49m[43mtfd[49m[38;5;241;43m.[39;49m[43mNormal[49m[43m([49m[38;5;241;43m0.[39;49m[43m,[49m[43m [49m[38;5;241;43m1.[39;49m[43m)[49m[43m,[49m[43m [49m[43msample_shape[49m[38;5;241;43m=[39;49m[43m([49m[43mdim_out[49m[43m,[49m[43m [49m[43mdim_in[49m[43m)[49m[43m)[49m[43m,[49m
[1;32m     14[0m [43m    [49m[43mname[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mw[39;49m[38;5;124;43m'[39;49m
[1;32m     15[0m [43m[49m[43m)[49m[43m([49m[43mw_key[49m[43m)[49m
[1;32m     16[0m b [38;5;241m=[39m random_variable(
[1;32m     17[0m     tfd[38;5;241m.[39mSample(tfd[38;5;241m.[39mNormal([38;5;241m0.[39m, [38;5;241m1.[39m), sample_shape[38;5;241m=[39m(dim_out,)),
[1;32m     18[0m     name[38;5;241m=[39m[38;5;124m'[39m[38;5;124mb[39m[38;5;124m'[39m
[1;32m     19[0m )(b_key)
[1;32m     21[0m [38;5;28;01mreturn[39;00m activation(jnp[38;5;241m.[39mdot(w, x) [38;5;241m+[39m b)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/distributions/distribution_extensions.py:109[0m, in [0;36mdistribution_random_variable.<locals>.wrapped[0;34m(key)[0m
[1;32m    106[0m   [38;5;28;01mreturn[39;00m result
[1;32m    107[0m [38;5;28;01mif[39;00m name [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    108[0m   [38;5;28;01mreturn[39;00m ppl[38;5;241m.[39mrandom_variable(
[0;32m--> 109[0m       [43mharvest[49m[38;5;241;43m.[39;49m[43mnest[49m[43m([49m[43msample[49m[43m,[49m[43m [49m[43mscope[49m[38;5;241;43m=[39;49m[43mname[49m[43m)[49m[43m([49m[43mkey[49m[43m)[49m, name[38;5;241m=[39mname)
[1;32m    110[0m [38;5;28;01mreturn[39;00m sample(key)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:314[0m, in [0;36mnest.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m    312[0m flat_args, in_tree [38;5;241m=[39m tree_util[38;5;241m.[39mtree_flatten(args)
[1;32m    313[0m flat_fun, out_tree [38;5;241m=[39m api_util[38;5;241m.[39mflatten_fun_nokwargs(fun, in_tree)
[0;32m--> 314[0m out_flat [38;5;241m=[39m [43mnest_p[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m
[1;32m    315[0m [43m    [49m[43mflat_fun[49m[43m,[49m
[1;32m    316[0m [43m    [49m[38;5;241;43m*[39;49m[43mflat_args[49m[43m,[49m
[1;32m    317[0m [43m    [49m[43mscope[49m[38;5;241;43m=[39;49m[43mscope[49m[43m,[49m
[1;32m    318[0m [43m    [49m[43mname[49m[38;5;241;43m=[39;49m[38;5;28;43mgetattr[39;49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43m__name__[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43m<no name>[39;49m[38;5;124;43m'[39;49m[43m)[49m[43m)[49m
[1;32m    319[0m [38;5;28;01mreturn[39;00m tree_util[38;5;241m.[39mtree_unflatten(out_tree(), out_flat)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:2309[0m, in [0;36mCallPrimitive.bind[0;34m(self, fun, *args, **params)[0m
[1;32m   2306[0m [38;5;28;01mdef[39;00m [38;5;21mbind[39m([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams):
[1;32m   2307[0m   call_bind_continuation, top_trace, fun_, tracers, params [38;5;241m=[39m (
[1;32m   2308[0m       call_bind_with_continuation([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams))
[0;32m-> 2309[0m   outs [38;5;241m=[39m [43mtop_trace[49m[38;5;241;43m.[39;49m[43mprocess_call[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mfun_[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m   2310[0m   [38;5;28;01mreturn[39;00m call_bind_continuation(outs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:365[0m, in [0;36mHarvestTrace.process_call[0;34m(self, call_primitive, f, tracers, params)[0m
[1;32m    363[0m context [38;5;241m=[39m trace_util[38;5;241m.[39mget_dynamic_context([38;5;28mself[39m)
[1;32m    364[0m [38;5;28;01mif[39;00m call_primitive [38;5;129;01mis[39;00m nest_p:
[0;32m--> 365[0m   [38;5;28;01mreturn[39;00m [43mcontext[49m[38;5;241;43m.[39;49m[43mprocess_nest[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mtracers[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m
[1;32m    366[0m [38;5;28;01mreturn[39;00m context[38;5;241m.[39mprocess_higher_order_primitive([38;5;28mself[39m, call_primitive, f,
[1;32m    367[0m                                               tracers, params, [38;5;28;01mFalse[39;00m)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:546[0m, in [0;36mReapContext.process_nest[0;34m(self, trace, f, scope, name, *tracers, **params)[0m
[1;32m    545[0m [38;5;28;01mdef[39;00m [38;5;21mprocess_nest[39m([38;5;28mself[39m, trace, f, [38;5;241m*[39mtracers, scope, name, [38;5;241m*[39m[38;5;241m*[39mparams):
[0;32m--> 546[0m   out_tracers, reap_tracers, _ [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreap_higher_order_primitive[49m[43m([49m
[1;32m    547[0m [43m      [49m[43mtrace[49m[43m,[49m[43m [49m[43mnest_p[49m[43m,[49m[43m [49m[43mf[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[38;5;28;43mdict[39;49m[43m([49m[43mparams[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m[43m [49m[43mscope[49m[38;5;241;43m=[39;49m[43mscope[49m[43m)[49m[43m,[49m[43m [49m[38;5;28;43;01mFalse[39;49;00m[43m)[49m
[1;32m    548[0m   tag [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msettings[38;5;241m.[39mtag
[1;32m    549[0m   [38;5;28;01mif[39;00m reap_tracers:

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:538[0m, in [0;36mReapContext.reap_higher_order_primitive[0;34m(self, trace, call_primitive, f, tracers, params, is_map)[0m
[1;32m    535[0m     [38;5;28;01mreturn[39;00m ([38;5;241m0[39m,) [38;5;241m*[39m out_tree[38;5;241m.[39mnum_leaves
[1;32m    537[0m   params [38;5;241m=[39m [38;5;28mdict[39m(params, out_axes_thunk[38;5;241m=[39mnew_out_axes_thunk)
[0;32m--> 538[0m out_flat [38;5;241m=[39m [43mcall_primitive[49m[38;5;241;43m.[39;49m[43mbind[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mvals[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m
[1;32m    539[0m out_tree, metadata [38;5;241m=[39m aux()
[1;32m    540[0m out_vals, reaps [38;5;241m=[39m tree_util[38;5;241m.[39mtree_unflatten(out_tree, out_flat)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:2309[0m, in [0;36mCallPrimitive.bind[0;34m(self, fun, *args, **params)[0m
[1;32m   2306[0m [38;5;28;01mdef[39;00m [38;5;21mbind[39m([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams):
[1;32m   2307[0m   call_bind_continuation, top_trace, fun_, tracers, params [38;5;241m=[39m (
[1;32m   2308[0m       call_bind_with_continuation([38;5;28mself[39m, fun, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mparams))
[0;32m-> 2309[0m   outs [38;5;241m=[39m [43mtop_trace[49m[38;5;241;43m.[39;49m[43mprocess_call[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mfun_[49m[43m,[49m[43m [49m[43mtracers[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[1;32m   2310[0m   [38;5;28;01mreturn[39;00m call_bind_continuation(outs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/core.py:938[0m, in [0;36mEvalTrace.process_call[0;34m(self, primitive, f, tracers, params)[0m
[1;32m    937[0m [38;5;28;01mdef[39;00m [38;5;21mprocess_call[39m([38;5;28mself[39m, primitive, f, tracers, params):
[0;32m--> 938[0m   [38;5;28;01mreturn[39;00m [43mprimitive[49m[38;5;241;43m.[39;49m[43mimpl[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43mtracers[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/interpreters/harvest.py:257[0m, in [0;36m_nest_impl[0;34m(f, *args, **_)[0m
[1;32m    255[0m [38;5;28;01mdef[39;00m [38;5;21m_nest_impl[39m(f, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39m_):
[1;32m    256[0m   [38;5;28;01mwith[39;00m jax_core[38;5;241m.[39mnew_sublevel():
[0;32m--> 257[0m     [38;5;28;01mreturn[39;00m [43mf[49m[38;5;241;43m.[39;49m[43mcall_wrapped[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/linear_util.py:191[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    188[0m gen [38;5;241m=[39m gen_static_args [38;5;241m=[39m out_store [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    190[0m [38;5;28;01mtry[39;00m:
[0;32m--> 191[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    192[0m [38;5;28;01mexcept[39;00m:
[1;32m    193[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    194[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    195[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    196[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    197[0m   [38;5;66;03m# state.[39;00m
[1;32m    198[0m   [38;5;28;01mwhile[39;00m stack:

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/distributions/distribution_extensions.py:101[0m, in [0;36mdistribution_random_variable.<locals>.wrapped.<locals>.sample[0;34m(key)[0m
[1;32m    100[0m [38;5;28;01mdef[39;00m [38;5;21msample[39m(key):
[0;32m--> 101[0m   result [38;5;241m=[39m [43mprimitive[49m[38;5;241;43m.[39;49m[43minitial_style_bind[49m[43m([49m
[1;32m    102[0m [43m      [49m[43mrandom_variable_p[49m[43m,[49m
[1;32m    103[0m [43m      [49m[43mbatch_ndims[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m,[49m
[1;32m    104[0m [43m      [49m[43mdistribution_name[49m[38;5;241;43m=[39;49m[43mdist[49m[38;5;241;43m.[39;49m[38;5;18;43m__class__[39;49m[38;5;241;43m.[39;49m[38;5;18;43m__name__[39;49m[43m)[49m[43m([49m[43m_sample_distribution[49m[43m)[49m[43m([49m
[1;32m    105[0m [43m          [49m[43mkey[49m[43m,[49m[43m [49m[43mdist[49m[43m)[49m
[1;32m    106[0m   [38;5;28;01mreturn[39;00m result

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/primitive.py:200[0m, in [0;36minitial_style_bind.<locals>.bind.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m    198[0m [38;5;28;01mdef[39;00m [38;5;21mwrapped[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    199[0m [38;5;250m  [39m[38;5;124;03m"""Runs a function and binds it to a call primitive."""[39;00m
[0;32m--> 200[0m   jaxpr, (in_tree, out_tree) [38;5;241m=[39m [43mtrace_util[49m[38;5;241;43m.[39;49m[43mstage[49m[43m([49m
[1;32m    201[0m [43m      [49m[43mf[49m[43m,[49m[43m [49m[43mdynamic[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m)[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    202[0m   flat_args [38;5;241m=[39m tree_util[38;5;241m.[39mtree_leaves(args)
[1;32m    203[0m   outs [38;5;241m=[39m prim[38;5;241m.[39mbind(
[1;32m    204[0m       [38;5;241m*[39mit[38;5;241m.[39mchain(jaxpr[38;5;241m.[39mliterals, flat_args),
[1;32m    205[0m       jaxpr[38;5;241m=[39mjaxpr[38;5;241m.[39mjaxpr,
[0;32m   (...)[0m
[1;32m    208[0m       num_consts[38;5;241m=[39m[38;5;28mlen[39m(jaxpr[38;5;241m.[39mliterals),
[1;32m    209[0m       [38;5;241m*[39m[38;5;241m*[39mparams)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/core/trace_util.py:65[0m, in [0;36mstage.<locals>.wrapped[0;34m(*args, **kwargs)[0m
[1;32m     63[0m flat_avals [38;5;241m=[39m safe_map(get_shaped_aval, flat_args)
[1;32m     64[0m [38;5;28;01mif[39;00m dynamic:
[0;32m---> 65[0m   jaxpr, _, consts [38;5;241m=[39m [43mpe[49m[38;5;241;43m.[39;49m[43mtrace_to_jaxpr_dynamic[49m[43m([49m
[1;32m     66[0m [43m      [49m[43mflat_fun[49m[43m,[49m
[1;32m     67[0m [43m      [49m[43mflat_avals[49m[43m)[49m
[1;32m     68[0m [38;5;28;01melse[39;00m:
[1;32m     69[0m   pvals [38;5;241m=[39m [pe[38;5;241m.[39mPartialVal[38;5;241m.[39munknown(aval) [38;5;28;01mfor[39;00m aval [38;5;129;01min[39;00m flat_avals]

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/profiler.py:336[0m, in [0;36mannotate_function.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    333[0m [38;5;129m@wraps[39m(func)
[1;32m    334[0m [38;5;28;01mdef[39;00m [38;5;21mwrapper[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    335[0m   [38;5;28;01mwith[39;00m TraceAnnotation(name, [38;5;241m*[39m[38;5;241m*[39mdecorator_kwargs):
[0;32m--> 336[0m     [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    337[0m   [38;5;28;01mreturn[39;00m wrapper

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py:2288[0m, in [0;36mtrace_to_jaxpr_dynamic[0;34m(fun, in_avals, debug_info, keep_inputs)[0m
[1;32m   2286[0m [38;5;28;01mwith[39;00m core[38;5;241m.[39mnew_main(DynamicJaxprTrace, dynamic[38;5;241m=[39m[38;5;28;01mTrue[39;00m) [38;5;28;01mas[39;00m main:  [38;5;66;03m# type: ignore[39;00m
[1;32m   2287[0m   main[38;5;241m.[39mjaxpr_stack [38;5;241m=[39m ()  [38;5;66;03m# type: ignore[39;00m
[0;32m-> 2288[0m   jaxpr, out_avals, consts [38;5;241m=[39m [43mtrace_to_subjaxpr_dynamic[49m[43m([49m
[1;32m   2289[0m [43m    [49m[43mfun[49m[43m,[49m[43m [49m[43mmain[49m[43m,[49m[43m [49m[43min_avals[49m[43m,[49m[43m [49m[43mkeep_inputs[49m[38;5;241;43m=[39;49m[43mkeep_inputs[49m[43m,[49m[43m [49m[43mdebug_info[49m[38;5;241;43m=[39;49m[43mdebug_info[49m[43m)[49m
[1;32m   2290[0m   [38;5;28;01mdel[39;00m main, fun
[1;32m   2291[0m [38;5;28;01mreturn[39;00m jaxpr, out_avals, consts

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py:2310[0m, in [0;36mtrace_to_subjaxpr_dynamic[0;34m(fun, main, in_avals, keep_inputs, debug_info)[0m
[1;32m   2308[0m in_tracers [38;5;241m=[39m _input_type_to_tracers(trace[38;5;241m.[39mnew_arg, in_avals)
[1;32m   2309[0m in_tracers_ [38;5;241m=[39m [t [38;5;28;01mfor[39;00m t, keep [38;5;129;01min[39;00m [38;5;28mzip[39m(in_tracers, keep_inputs) [38;5;28;01mif[39;00m keep]
[0;32m-> 2310[0m ans [38;5;241m=[39m [43mfun[49m[38;5;241;43m.[39;49m[43mcall_wrapped[49m[43m([49m[38;5;241;43m*[39;49m[43min_tracers_[49m[43m)[49m
[1;32m   2311[0m out_tracers [38;5;241m=[39m [38;5;28mmap[39m(trace[38;5;241m.[39mfull_raise, ans)
[1;32m   2312[0m jaxpr, consts [38;5;241m=[39m frame[38;5;241m.[39mto_jaxpr(out_tracers)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/jax/_src/linear_util.py:191[0m, in [0;36mWrappedFun.call_wrapped[0;34m(self, *args, **kwargs)[0m
[1;32m    188[0m gen [38;5;241m=[39m gen_static_args [38;5;241m=[39m out_store [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    190[0m [38;5;28;01mtry[39;00m:
[0;32m--> 191[0m   ans [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mdict[39;49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mparams[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m[43m)[49m
[1;32m    192[0m [38;5;28;01mexcept[39;00m:
[1;32m    193[0m   [38;5;66;03m# Some transformations yield from inside context managers, so we have to[39;00m
[1;32m    194[0m   [38;5;66;03m# interrupt them before reraising the exception. Otherwise they will only[39;00m
[1;32m    195[0m   [38;5;66;03m# get garbage-collected at some later time, running their cleanup tasks[39;00m
[1;32m    196[0m   [38;5;66;03m# only after this exception is handled, which can corrupt the global[39;00m
[1;32m    197[0m   [38;5;66;03m# state.[39;00m
[1;32m    198[0m   [38;5;28;01mwhile[39;00m stack:

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/oryx/distributions/distribution_extensions.py:85[0m, in [0;36m_sample_distribution[0;34m(key, dist)[0m
[1;32m     84[0m [38;5;28;01mdef[39;00m [38;5;21m_sample_distribution[39m(key, dist):
[0;32m---> 85[0m   [38;5;28;01mreturn[39;00m [43mdist[49m[38;5;241;43m.[39;49m[43msample[49m[43m([49m[43mseed[49m[38;5;241;43m=[39;49m[43mkey[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/distribution.py:1205[0m, in [0;36mDistribution.sample[0;34m(self, sample_shape, seed, name, **kwargs)[0m
[1;32m   1190[0m [38;5;250m[39m[38;5;124;03m"""Generate samples of the specified shape.[39;00m
[1;32m   1191[0m 
[1;32m   1192[0m [38;5;124;03mNote that a call to `sample()` without arguments will generate a single[39;00m
[0;32m   (...)[0m
[1;32m   1202[0m [38;5;124;03m  samples: a `Tensor` with prepended dimensions `sample_shape`.[39;00m
[1;32m   1203[0m [38;5;124;03m"""[39;00m
[1;32m   1204[0m [38;5;28;01mwith[39;00m [38;5;28mself[39m[38;5;241m.[39m_name_and_control_scope(name):
[0;32m-> 1205[0m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_sample_n[49m[43m([49m[43msample_shape[49m[43m,[49m[43m [49m[43mseed[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/distribution.py:1182[0m, in [0;36mDistribution._call_sample_n[0;34m(self, sample_shape, seed, **kwargs)[0m
[1;32m   1178[0m sample_shape [38;5;241m=[39m ps[38;5;241m.[39mconvert_to_shape_tensor(
[1;32m   1179[0m     ps[38;5;241m.[39mcast(sample_shape, tf[38;5;241m.[39mint32), name[38;5;241m=[39m[38;5;124m'[39m[38;5;124msample_shape[39m[38;5;124m'[39m)
[1;32m   1180[0m sample_shape, n [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_expand_sample_shape_to_vector(
[1;32m   1181[0m     sample_shape, [38;5;124m'[39m[38;5;124msample_shape[39m[38;5;124m'[39m)
[0;32m-> 1182[0m samples [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_sample_n[49m[43m([49m
[1;32m   1183[0m [43m    [49m[43mn[49m[43m,[49m[43m [49m[43mseed[49m[38;5;241;43m=[39;49m[43mseed[49m[43m([49m[43m)[49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;28;43mcallable[39;49m[43m([49m[43mseed[49m[43m)[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mseed[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1184[0m samples [38;5;241m=[39m tf[38;5;241m.[39mnest[38;5;241m.[39mmap_structure(
[1;32m   1185[0m     [38;5;28;01mlambda[39;00m x: tf[38;5;241m.[39mreshape(x, ps[38;5;241m.[39mconcat([sample_shape, ps[38;5;241m.[39mshape(x)[[38;5;241m1[39m:]], [38;5;241m0[39m)),
[1;32m   1186[0m     samples)
[1;32m   1187[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_set_sample_static_shape(samples, sample_shape, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/sample.py:224[0m, in [0;36m_Sample._sample_n[0;34m(self, n, seed, **kwargs)[0m
[1;32m    222[0m [38;5;28;01mdef[39;00m [38;5;21m_sample_n[39m([38;5;28mself[39m, n, seed, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    223[0m   sample_shape [38;5;241m=[39m ps[38;5;241m.[39mreshape([38;5;28mself[39m[38;5;241m.[39msample_shape, shape[38;5;241m=[39m[[38;5;241m-[39m[38;5;241m1[39m])
[0;32m--> 224[0m   x [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdistribution[49m[38;5;241;43m.[39;49m[43msample[49m[43m([49m[43mps[49m[38;5;241;43m.[39;49m[43mconcat[49m[43m([49m[43m[[49m[43m[[49m[43mn[49m[43m][49m[43m,[49m[43m [49m[43msample_shape[49m[43m][49m[43m,[49m[43m [49m[43maxis[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m[43m,[49m
[1;32m    225[0m [43m                               [49m[43mseed[49m[38;5;241;43m=[39;49m[43mseed[49m[43m,[49m
[1;32m    226[0m [43m                               [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    227[0m   [38;5;28;01mreturn[39;00m tf[38;5;241m.[39mtranspose(a[38;5;241m=[39mx, perm[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39m_sampling_permutation(sample_ndims[38;5;241m=[39m[38;5;241m1[39m))

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/distribution.py:1205[0m, in [0;36mDistribution.sample[0;34m(self, sample_shape, seed, name, **kwargs)[0m
[1;32m   1190[0m [38;5;250m[39m[38;5;124;03m"""Generate samples of the specified shape.[39;00m
[1;32m   1191[0m 
[1;32m   1192[0m [38;5;124;03mNote that a call to `sample()` without arguments will generate a single[39;00m
[0;32m   (...)[0m
[1;32m   1202[0m [38;5;124;03m  samples: a `Tensor` with prepended dimensions `sample_shape`.[39;00m
[1;32m   1203[0m [38;5;124;03m"""[39;00m
[1;32m   1204[0m [38;5;28;01mwith[39;00m [38;5;28mself[39m[38;5;241m.[39m_name_and_control_scope(name):
[0;32m-> 1205[0m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_call_sample_n[49m[43m([49m[43msample_shape[49m[43m,[49m[43m [49m[43mseed[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/distribution.py:1182[0m, in [0;36mDistribution._call_sample_n[0;34m(self, sample_shape, seed, **kwargs)[0m
[1;32m   1178[0m sample_shape [38;5;241m=[39m ps[38;5;241m.[39mconvert_to_shape_tensor(
[1;32m   1179[0m     ps[38;5;241m.[39mcast(sample_shape, tf[38;5;241m.[39mint32), name[38;5;241m=[39m[38;5;124m'[39m[38;5;124msample_shape[39m[38;5;124m'[39m)
[1;32m   1180[0m sample_shape, n [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_expand_sample_shape_to_vector(
[1;32m   1181[0m     sample_shape, [38;5;124m'[39m[38;5;124msample_shape[39m[38;5;124m'[39m)
[0;32m-> 1182[0m samples [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_sample_n[49m[43m([49m
[1;32m   1183[0m [43m    [49m[43mn[49m[43m,[49m[43m [49m[43mseed[49m[38;5;241;43m=[39;49m[43mseed[49m[43m([49m[43m)[49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[38;5;28;43mcallable[39;49m[43m([49m[43mseed[49m[43m)[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mseed[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m   1184[0m samples [38;5;241m=[39m tf[38;5;241m.[39mnest[38;5;241m.[39mmap_structure(
[1;32m   1185[0m     [38;5;28;01mlambda[39;00m x: tf[38;5;241m.[39mreshape(x, ps[38;5;241m.[39mconcat([sample_shape, ps[38;5;241m.[39mshape(x)[[38;5;241m1[39m:]], [38;5;241m0[39m)),
[1;32m   1186[0m     samples)
[1;32m   1187[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_set_sample_static_shape(samples, sample_shape, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/distributions/normal.py:179[0m, in [0;36mNormal._sample_n[0;34m(self, n, seed)[0m
[1;32m    176[0m scale [38;5;241m=[39m tf[38;5;241m.[39mconvert_to_tensor([38;5;28mself[39m[38;5;241m.[39mscale)
[1;32m    177[0m shape [38;5;241m=[39m ps[38;5;241m.[39mconcat([[n], [38;5;28mself[39m[38;5;241m.[39m_batch_shape_tensor(loc[38;5;241m=[39mloc, scale[38;5;241m=[39mscale)],
[1;32m    178[0m                   axis[38;5;241m=[39m[38;5;241m0[39m)
[0;32m--> 179[0m sampled [38;5;241m=[39m [43msamplers[49m[38;5;241;43m.[39;49m[43mnormal[49m[43m([49m
[1;32m    180[0m [43m    [49m[43mshape[49m[38;5;241;43m=[39;49m[43mshape[49m[43m,[49m[43m [49m[43mmean[49m[38;5;241;43m=[39;49m[38;5;241;43m0.[39;49m[43m,[49m[43m [49m[43mstddev[49m[38;5;241;43m=[39;49m[38;5;241;43m1.[39;49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdtype[49m[43m,[49m[43m [49m[43mseed[49m[38;5;241;43m=[39;49m[43mseed[49m[43m)[49m
[1;32m    181[0m [38;5;28;01mreturn[39;00m sampled [38;5;241m*[39m scale [38;5;241m+[39m loc

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/internal/samplers.py:270[0m, in [0;36mnormal[0;34m(shape, mean, stddev, dtype, seed, name)[0m
[1;32m    266[0m [38;5;28;01mif[39;00m is_stateful_seed(seed):
[1;32m    267[0m   [38;5;28;01mreturn[39;00m tf[38;5;241m.[39mrandom[38;5;241m.[39mstateless_normal(
[1;32m    268[0m       shape[38;5;241m=[39mshape, seed[38;5;241m=[39mseed, mean[38;5;241m=[39mmean, stddev[38;5;241m=[39mstddev, dtype[38;5;241m=[39mdtype)
[0;32m--> 270[0m seed [38;5;241m=[39m [43msanitize_seed[49m[43m([49m[43mseed[49m[43m)[49m
[1;32m    271[0m [38;5;28;01mreturn[39;00m tf[38;5;241m.[39mrandom[38;5;241m.[39mstateless_normal(
[1;32m    272[0m     shape[38;5;241m=[39mshape, seed[38;5;241m=[39mseed, mean[38;5;241m=[39mmean, stddev[38;5;241m=[39mstddev, dtype[38;5;241m=[39mdtype)

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/substrates/jax/internal/samplers.py:142[0m, in [0;36msanitize_seed[0;34m(seed, salt, name)[0m
[1;32m    139[0m   salt [38;5;241m=[39m [38;5;28mint[39m(hashlib[38;5;241m.[39msha512([38;5;28mstr[39m(salt)[38;5;241m.[39mencode([38;5;124m'[39m[38;5;124mutf-8[39m[38;5;124m'[39m))[38;5;241m.[39mhexdigest(), [38;5;241m16[39m)
[1;32m    140[0m   seed [38;5;241m=[39m fold_in(seed, salt)
[0;32m--> 142[0m [38;5;28;01mreturn[39;00m [43mtf[49m[38;5;241;43m.[39;49m[43mconvert_to_tensor[49m[43m([49m[43mseed[49m[43m,[49m[43m [49m[43mdtype[49m[38;5;241;43m=[39;49m[43mSEED_DTYPE[49m[43m,[49m[43m [49m[43mname[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mseed[39;49m[38;5;124;43m'[39;49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/tensorflow_probability/python/internal/backend/jax/ops.py:151[0m, in [0;36m_convert_to_tensor[0;34m(value, dtype, dtype_hint, name)[0m
[1;32m    149[0m [38;5;28;01mif[39;00m dtype [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m value[38;5;241m.[39mdtype [38;5;241m!=[39m dtype:
[1;32m    150[0m   [38;5;28;01mif[39;00m JAX_MODE:
[0;32m--> 151[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(([38;5;124m'[39m[38;5;124mTensor conversion requested dtype [39m[38;5;132;01m{}[39;00m[38;5;124m for array with [39m[38;5;124m'[39m
[1;32m    152[0m                      [38;5;124m'[39m[38;5;124mdtype [39m[38;5;132;01m{}[39;00m[38;5;124m: [39m[38;5;132;01m{}[39;00m[38;5;124m'[39m)[38;5;241m.[39mformat(dtype, value[38;5;241m.[39mdtype, value))
[1;32m    153[0m   [38;5;28;01mreturn[39;00m value[38;5;241m.[39mastype(dtype)
[1;32m    154[0m [38;5;28;01mreturn[39;00m value

[0;31mTypeError[0m: Tensor conversion requested dtype <class 'numpy.uint32'> for array with dtype key<fry>: Traced<ShapedArray(key<fry>[])>with<DynamicJaxprTrace(level=2/2)>

